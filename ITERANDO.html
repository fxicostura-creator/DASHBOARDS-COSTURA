<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FXI CUAUTITLAN · 3 Vistas</title>
  <style>
    :root {
      --bg: #0a0f1a;
      --fg: #e6eef7;
      --muted: #8aa0b8;
      --accent: #42a5f5;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji'; background: var(--bg); color: var(--fg); }
    .app { display: grid; grid-template-rows: auto 1fr; height: 100%; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 12px; padding: 10px 14px; background: rgba(255,255,255,0.04); border-bottom: 1px solid rgba(255,255,255,0.08); position: sticky; top: 0; backdrop-filter: blur(6px); }
    .title { display:flex; align-items:center; gap:10px; font-weight: 600; letter-spacing: .2px; }
    .title .dot { width:10px; height:10px; border-radius:999px; background: var(--accent); box-shadow: 0 0 12px var(--accent); }
    .subtitle { font-size: 12px; color: var(--muted); }
    .controls { display:flex; align-items:center; gap:8px; flex-wrap: wrap; }
    button, select { background: rgba(255,255,255,0.06); color: var(--fg); border: 1px solid rgba(255,255,255,0.12); padding: 8px 10px; border-radius: 12px; font-weight: 600; cursor: pointer; }
    button:hover, select:hover { border-color: rgba(255,255,255,0.22); }
    button:active { transform: translateY(1px); }
    .status { font-size: 12px; color: var(--muted); }
    .stage { position: relative; height: 100%; }
    .frame { position:absolute; inset:0; width:100%; height:100%; border:0; border-radius: 16px; overflow:hidden; opacity:0; pointer-events:none; transition: opacity .35s ease; background:#000; }
    .frame.active { opacity:1; pointer-events:auto; }
    .badge { position: absolute; right: 14px; bottom: 14px; background: rgba(0,0,0,.45); color: #fff; padding: 6px 10px; border-radius: 999px; font-size: 12px; letter-spacing: .3px; backdrop-filter: blur(4px); border: 1px solid rgba(255,255,255,.18); }
    .hint { display:none; }
    @media (max-width:720px){ .subtitle{display:none;} }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <span class="dot" aria-hidden="true"></span>
        <div>
          <div>FXI CUAUTITLAN</div>
          <div class="subtitle" id="now">—</div>
        </div>
      </div>
      <div class="controls">
        <select id="selector" title="Elegir dashboard">
          <option value="0">COMFORT GRANDE V-201</option>
          <option value="1">ENGAGE PRO</option>
          <option value="2">COSTCO 8"</option>
        </select>
        <button id="prev" title="Anterior (←)">⟵ Anterior</button>
        <button id="next" title="Siguiente (→)">Siguiente ⟶</button>
        <button id="pause" title="Espacio para pausar/reanudar">⏸️ Pausa</button>
        <span class="status" id="status">Intervalo: 15 s</span>
      </div>
    </header>

    <main class="stage">
      <!-- Mantener las 3 iframes montadas evita recargas al rotar -->
      <iframe id="f0" class="frame active" src="about:blank" title="COMFORT GRANDE V-201" loading="eager" referrerpolicy="no-referrer"></iframe>
      <iframe id="f1" class="frame" src="about:blank" title="ENGAGE PRO" loading="eager" referrerpolicy="no-referrer"></iframe>
      <iframe id="f2" class="frame" src="about:blank" title="COSTCO 8" loading="eager" referrerpolicy="no-referrer"></iframe>
      <div class="badge" id="badge">1 / 3</div>
    </main>
  </div>

  <script>
    // === CONFIGURA AQUÍ TUS TRES ENLACES ===
    // Reemplaza estas URLs por las de tus dashboards
    const DASHBOARDS = [
      { title: 'COMFORT GRANDE V-201', url: 'https://fxicostura-creator.github.io/DASHBOARDS-COSTURA/COMFORT%20GRANDE%20V-201.html' },
      { title: 'ENGAGE PRO', url: 'https://fxicostura-creator.github.io/DASHBOARDS-COSTURA/MOLECULE%20ENGAGE%20PRO' },
      { title: 'COSTCO 8"', url: 'https://fxicostura-creator.github.io/DASHBOARDS-COSTURA/COSTCO%208.html' },
    ];

    // Intervalo en segundos (puedes pasar ?t=15 en la URL para cambiarlo rápidamente)
    const q = new URLSearchParams(location.search);
    const INTERVAL_SECONDS = Number(q.get('t')) > 0 ? Number(q.get('t')) : 15;

    // === LÓGICA ===
    const frames = [document.getElementById('f0'), document.getElementById('f1'), document.getElementById('f2')];
    const selector = document.getElementById('selector');
    const btnPrev = document.getElementById('prev');
    const btnNext = document.getElementById('next');
    const btnPause = document.getElementById('pause');
    const status = document.getElementById('status');
    const badge = document.getElementById('badge');
    const nowEl = document.getElementById('now');

    let idx = 0;
    let paused = false;
    let timer = null;

    // Carga inicial de URLs y títulos del selector
    DASHBOARDS.forEach((d, i) => {
      frames[i].src = d.url;
      frames[i].title = d.title;
      selector.options[i].textContent = d.title;
    });

    function setActive(newIdx){
      idx = ((newIdx % 3) + 3) % 3; // wrap seguro
      frames.forEach((f,i)=> f.classList.toggle('active', i===idx));
      selector.value = String(idx);
      badge.textContent = `${idx+1} / 3`;
      document.title = `Rotador · ${DASHBOARDS[idx].title}`;
    }

    function tick(){ if(!paused) setActive(idx+1); }

    function startTimer(){ stopTimer(); timer = setInterval(tick, INTERVAL_SECONDS*1000); }
    function stopTimer(){ if(timer){ clearInterval(timer); timer = null; } }

    // Controles
    btnPrev.addEventListener('click', ()=>{ setActive(idx-1); startTimer(); });
    btnNext.addEventListener('click', ()=>{ setActive(idx+1); startTimer(); });
    selector.addEventListener('change', (e)=>{ setActive(Number(e.target.value)); startTimer(); });

    btnPause.addEventListener('click', ()=>{
      paused = !paused;
      btnPause.textContent = paused ? '▶️ Reanudar' : '⏸️ Pausa';
      if(paused) stopTimer(); else startTimer();
    });

    // Atajos de teclado
    addEventListener('keydown', (e)=>{
      if(e.key === 'ArrowLeft'){ btnPrev.click(); }
      if(e.key === 'ArrowRight'){ btnNext.click(); }
      if(e.code === 'Space'){ e.preventDefault(); btnPause.click(); }
    });

    // Pausar si la pestaña no está visible para ahorrar recursos
    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden){ stopTimer(); }
      else if(!paused){ startTimer(); }
    });

    // Reloj y estado
    function updateClock(){
      const now = new Date();
      const fmt = now.toLocaleString('es-MX', { dateStyle:'medium', timeStyle:'medium' });
      nowEl.textContent = `Mostrando: ${DASHBOARDS[idx].title} • ${fmt}`;
      status.textContent = `Intervalo: ${INTERVAL_SECONDS} s${paused ? ' (pausado)' : ''}`;
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Arranque
    setActive(0);
    startTimer();
  </script>
</body>
</html>
